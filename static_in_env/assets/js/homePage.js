jQuery(document).ready(function($){if(homepage){initOwlCarousel();}
var globalCoordinate={};var options={enableHighAccuracy:true,timeout:5000,maximumAge:0};function getPositionRelatedData(coordinates){if(homepage){getNearbyNews(coordinates);getNearbyEvents(coordinates);}
getWeather(coordinates);}
var currentTime=new Date();var dateInHailTimezone=new Date((currentTime.getTime()+(currentTime.getTimezoneOffset()*60000))+(3600000*3));var currentDayDate=dateInHailTimezone.toLocaleDateString('ar-SA',{weekday:'long',year:'numeric',month:'long',day:'numeric'});var todayDate=currentTime.getFullYear()+'-'+(currentTime.getMonth()+1)+'-'+currentTime.getDate();var prayerNames={'Fajr':'الفجر','Dhuhr':'الظهر','Asr':'العصر','Maghrib':'المغرب','Isha':'العشاء'};function getTimeStringFromDateObject(status){var timeStatus='AM';if(status=="مساءًا"){timeStatus='PM';}
return timeStatus;}
function getWeather(pos){$.ajax({url:getWeatherInfoUrl,data:{"long":pos.longitude,"lat":pos.latitude},success:function(dataObject){if(dataObject.weather&&!$.isEmptyObject(dataObject.weather)){$('.dev-city').html(dataObject.city);$('#dev-weatherName').html(dataObject.city);var weakWeather=dataObject.weather;if(weakWeather.length>0){for(var i=0;i<7;i++){$('.dev-show-weather').append('<div class="weather-block"><div class="h3">'+weakWeather[i].dayAr+'</div>'+
'<img   src="'+weakWeather[i].image+'" />'+
'<div class="h3">'+weakWeather[i].temperatureHigh+'</div>'
+'<div class="h3">'+weakWeather[i].temperatureLow+'</div></div>');if(weakWeather[i].today){$('weather-popup-'+weakWeather[i].day).attr('class','prayer-item row text-center active');$('.weather-icon').attr('src',weakWeather[i].image);$('.dev-weatherTempIcon').attr('src',weakWeather[i].image);$('.weather-date').html(weakWeather[i].currentDayDate);$('.weather-status').html(weakWeather[i].textAr);$('.weather-temp').html(weakWeather[i].temperatureHigh);$('.dev-weatherTempNow').html(weakWeather[i].temperatureHigh);$('.weather-templow').html(weakWeather[i].temperatureLow);}}
$('#weather-container').show()}}else{$('#dev-weather').addClass('hide');}}});}
function initOwlCarousel(){$('.owl-carousel').owlCarousel('destroy');$('.owl-carousel').owlCarousel({rtl:isRtl,loop:false,margin:10,autoplay:true,autoplayTimeout:3000,autoplayHoverPause:true,nav:true,navText:["<i class='flaticon-right-arrow'></i>","<i class='flaticon-arrows'></i>"],responsive:{0:{items:1},500:{items:2},740:{items:3},1200:{items:3},1300:{items:4}}});}
function geolocationSuccess(pos){var getLocationObject=pos.coords;console.log("Success Loc");var crd={latitude:getLocationObject.latitude,longitude:getLocationObject.longitude};setCoordinates(crd);getPositionRelatedData(crd);}
function geolocationError(err){console.log("Error Loc");$.ajax({url:'https://ipinfo.io/geo',success:function(response){var coordinates=response.loc.split(',');var crd={latitude:coordinates[0],longitude:coordinates[1]};setCoordinates(crd);getPositionRelatedData(crd);}});}
function getEventsByGeoLocation(){getNearbyEvents(globalCoordinate);}
function setCoordinates(crd){globalCoordinate={latitude:crd.latitude,longitude:crd.longitude};}
function getNearbyNews(pos){$.ajax({url:$("#citySliderContainer").attr('get-data-url'),method:'GET',data:{"long":pos.longitude,"lat":pos.latitude},success:function(responseData){if(responseData.length>1){$("#citySliderContainer").html(responseData);$("#owl-slider").show();initOwlCarousel();}}});}
function getNearbyEvents(pos){$.ajax({url:cityEventsPath,method:'GET',data:{"long":pos.longitude,"lat":pos.latitude},success:function(responseData){$('#eventItems').html(responseData);}});}
$("#getNearByEvents").on("changed.bs.select",function(e,clickedIndex,newValue,oldValue){var value=this.value;if(value==='all'){getEventsByGeoLocation();}else{$.ajax({url:cityEventsPath,method:'GET',data:{'cityId':value},success:function(responseData){$('#eventItems').html(responseData);}});}});$('#citiesList').selectpicker('val',$("#citiesList option:first").val());});